(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[731],{6047:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5155),a=s(2115),l=s(5695),n=s(7027),i=s(2038),d=s(9323);function o(e){let{content:t,onChange:s}=e;return(0,r.jsx)("div",{children:(0,r.jsx)("textarea",{id:"content",value:t,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 border rounded-lg h-[500px] dark:bg-gray-800 dark:border-gray-700 transition-colors duration-300",required:!0})})}function c(e){let{content:t}=e;return(0,r.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none h-[500px] overflow-auto p-3 border rounded-lg dark:bg-gray-800 dark:border-gray-700 transition-colors duration-300",children:t?(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:t}}):(0,r.jsx)("div",{className:"text-gray-500 italic",children:"Начните вводить текст для предпросмотра..."})})}var u=s(7489),x=s(3578);function g(e){let{mode:t,onToggle:s}=e,a={hidden:x.pS3,split:[x.pS3,x.fGk],full:x.k6j};return(0,r.jsx)("button",{type:"button",onClick:s,className:"text-purple-600 hover:text-purple-700 p-1 rounded transition-colors h-8 w-8 flex items-center justify-center",title:{hidden:"Показать предпросмотр",split:"Развернуть предпросмотр",full:"Скрыть предпросмотр"}[t],children:"split"===t?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.g,{icon:x.pS3,className:"w-4 h-4"}),(0,r.jsx)(u.g,{icon:x.fGk,className:"w-3 h-3 absolute -bottom-1 -right-1"})]}):(0,r.jsx)(u.g,{icon:a[t],className:"w-4 h-4"})})}var h=s(7883);function m(){return(0,r.jsxs)("div",{className:"group relative inline-block",children:[(0,r.jsx)(u.g,{icon:h.APe,className:"w-4 h-4 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 cursor-help ml-1"}),(0,r.jsx)("div",{className:"hidden group-hover:block absolute left-0 top-6 w-64 p-4 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow-lg z-10",children:(0,r.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,r.jsx)("li",{children:(0,r.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"# Заголовок"})}),(0,r.jsx)("li",{children:(0,r.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"**жирный**"})}),(0,r.jsx)("li",{children:(0,r.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"*курсив*"})}),(0,r.jsx)("li",{children:(0,r.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"[ссылка](url)"})}),(0,r.jsx)("li",{children:(0,r.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"- список"})}),(0,r.jsx)("li",{children:(0,r.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"\\`код\\`"})})]})})]})}function b(){return(0,r.jsx)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(u.g,{icon:x.iW_,className:"w-5 h-5 text-blue-500 dark:text-blue-400 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-1",children:"Требуется авторизация через GitHub"}),(0,r.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Для отправки статьи вам потребуется авторизоваться через GitHub. После заполнения формы вы будете перенаправлены на страницу авторизации, где сможете предоставить доступ для создания pull request."})]})]})})}function p(){let e=(0,l.useRouter)(),[t,s]=(0,a.useState)({title:"",content:"",author:""}),[u,x]=(0,a.useState)(""),[h,p]=(0,a.useState)("split"),j=async e=>{s(t=>({...t,content:e})),x((await (0,n.V)().use(i.A).process(e)).toString())},y=async s=>{s.preventDefault(),(0,d.lL)(t);let r=Math.random().toString(36).substring(7),a=(0,d.dT)(r);e.push(a)},f=()=>{p(e=>{switch(e){case"hidden":return"split";case"split":return"full";case"full":return"hidden"}})};return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Предложить статью"}),(0,r.jsx)(b,{}),(0,r.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium mb-1",children:"Заголовок"}),(0,r.jsx)("input",{type:"text",id:"title",value:t.title,onChange:e=>s(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-800 dark:border-gray-700",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"author",className:"block text-sm font-medium mb-1",children:"Автор"}),(0,r.jsx)("input",{type:"text",id:"author",value:t.author,onChange:e=>s(t=>({...t,author:e.target.value})),className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-800 dark:border-gray-700",required:!0})]}),(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)("div",{className:"grid gap-6 ".concat("split"===h?"grid-cols-2":"grid-cols-1"),children:[(0,r.jsxs)("div",{className:"transition-all transform duration-300 ease-in-out ".concat("full"===h?"opacity-0 scale-95 absolute inset-0":"opacity-100 scale-100"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-8 mb-1",children:[(0,r.jsxs)("label",{htmlFor:"content",className:"block text-sm font-medium flex items-center",children:["Содержание (Markdown)",(0,r.jsx)(m,{})]}),"hidden"===h&&(0,r.jsx)(g,{mode:h,onToggle:f})]}),(0,r.jsx)(o,{content:t.content,onChange:j})]}),"hidden"!==h&&(0,r.jsxs)("div",{className:"transition-all transform duration-300 ease-in-out opacity-100 scale-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-8 mb-1",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:"Предпросмотр"}),(0,r.jsx)(g,{mode:h,onToggle:f})]}),(0,r.jsx)(c,{content:u})]})]})}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.push("/"),className:"btn bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700",children:"Отмена"}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Отправить"})]})]})]})}},8872:(e,t,s)=>{Promise.resolve().then(s.bind(s,6047))},9323:(e,t,s)=>{"use strict";s.d(t,{Ai:()=>i,HN:()=>d,dT:()=>a,iD:()=>l,lL:()=>n});let r=s(1890).env.NEXT_PUBLIC_GITHUB_CLIENT_ID||"";function a(e){let t=new URLSearchParams({client_id:r,redirect_uri:"".concat(window.location.origin,"/auth/callback"),scope:"public_repo",state:e,allow_signup:"true"});return"".concat("https://github.com/login/oauth/authorize","?").concat(t.toString())}async function l(e){let t=await fetch("/api/auth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}),s=await t.json();if(!t.ok)throw Error(s.message||"Failed to get access token");return s.access_token}function n(e){sessionStorage.setItem("pendingPost",JSON.stringify(e))}function i(){let e=sessionStorage.getItem("pendingPost");return e?JSON.parse(e):null}function d(){sessionStorage.removeItem("pendingPost")}}},e=>{var t=t=>e(e.s=t);e.O(0,[266,919,310,441,684,358],()=>t(8872)),_N_E=e.O()}]);